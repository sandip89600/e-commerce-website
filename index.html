<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>E-Com Apparel Store — Demo</title>

  <!-- Bootstrap & Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <style>
    :root{
      --accent1:#0d6efd;
      --card-radius:12px;
    }
    body{background:#f5f7fb;color:#222;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    .navbar { background: linear-gradient(90deg,var(--accent1), #0b5ed7); }
    .card{ border-radius:var(--card-radius); transition: transform .18s ease, box-shadow .18s ease; }
    .card:hover{ transform: translateY(-6px); box-shadow: 0 10px 20px rgba(13,110,253,.12); }
    .badge-cart { position: absolute; transform: translate(50%,-50%); top:0; right:0; }
    .product-img{ height:200px; object-fit:cover; border-top-left-radius:var(--card-radius); border-top-right-radius:var(--card-radius); }
    .category-btn.active { box-shadow: 0 6px 18px rgba(0,0,0,.08); }
    footer{ background: linear-gradient(90deg,var(--accent1), #0b5ed7); color:white; }
    @media (max-width:576px){ .product-img { height:160px; } }
  </style>
</head>
<body>

<!-- NAV -->
<nav class="navbar navbar-expand-lg navbar-dark sticky-top">
  <div class="container">
    <a class="navbar-brand fw-bold" href="#">Sandeep Apparel</a>

    <div class="d-flex align-items-center ms-auto">
      <input id="searchInput" class="form-control form-control-sm me-3" placeholder="Search products..." style="min-width:200px">
      <button class="btn btn-outline-light me-2" id="clearFiltersBtn" title="Clear filters">
        <i class="fa fa-times"></i>
      </button>

      <div class="position-relative me-2">
        <button class="btn btn-light" id="cartButton" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas" aria-controls="cartOffcanvas">
          <i class="fa fa-shopping-cart"></i>
        </button>
        <span id="cartCountBadge" class="badge bg-danger rounded-pill badge-cart d-none">0</span>
      </div>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navCollapse">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>

    <div class="collapse navbar-collapse" id="navCollapse">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a href="#shirts" class="nav-link">Shirts</a></li>
        <li class="nav-item"><a href="#pants" class="nav-link">Pants</a></li>
        <li class="nav-item"><a href="#shoes" class="nav-link">Shoes</a></li>
        <li class="nav-item"><a href="#mobile" class="nav-link">Mobile</a></li>
        <li class="nav-item"><a href="#contact-us" class="nav-link">Contact</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- PAGE CONTENT -->
<main class="container my-4">

  <!-- Category Buttons -->
  <div class="mb-4 d-flex flex-wrap gap-2">
    <button class="btn btn-outline-primary category-btn active" data-cat="all">All</button>
    <button class="btn btn-outline-primary category-btn" data-cat="Shirts">Shirts</button>
    <button class="btn btn-outline-primary category-btn" data-cat="Pants">Pants</button>
    <button class="btn btn-outline-primary category-btn" data-cat="Shoes">Shoes</button>
    <button class="btn btn-outline-primary category-btn" data-cat="Mobile">Mobile</button>
  </div>

  <!-- PRODUCTS GRID -->
  <div id="productsGrid" class="row g-3"></div>

  <!-- Contact -->
  <div id="contact-us" class="mt-5 p-4 bg-white rounded shadow-sm">
    <h4>Contact Us</h4>
    <form id="contactForm" class="row g-3">
      <div class="col-md-6">
        <label class="form-label">Name</label>
        <input class="form-control" id="contactName" required>
      </div>
      <div class="col-md-6">
        <label class="form-label">Email</label>
        <input class="form-control" id="contactEmail" type="email" required>
      </div>
      <div class="col-12">
        <label class="form-label">Message</label>
        <textarea id="contactMessage" class="form-control" rows="3" required></textarea>
      </div>
      <div class="col-12 text-end">
        <button class="btn btn-primary" type="submit">Send</button>
      </div>
    </form>
  </div>

</main>

<!-- OFFCANVAS CART -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="cartOffcanvas" aria-labelledby="cartOffcanvasLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="cartOffcanvasLabel"><i class="fa fa-shopping-cart me-2"></i>Your Cart</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
  </div>
  <div class="offcanvas-body d-flex flex-column">
    <div id="cartItemsWrap" class="mb-3"></div>

    <div class="mt-auto">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <strong>Total</strong>
        <h5 id="cartTotal">Rs 0</h5>
      </div>
      <div class="d-flex gap-2">
        <button id="clearCartBtn" class="btn btn-outline-secondary w-50">Clear</button>
        <button id="checkoutBtn" class="btn btn-primary w-50">Checkout</button>
      </div>
    </div>
  </div>
</div>

<!-- Simple Checkout Modal -->
<div class="modal fade" id="checkoutModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Checkout</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p id="checkoutSummary"></p>
        <p class="small text-muted">This demo does not process real payments. It simulates order placement and clears the cart.</p>
      </div>
      <div class="modal-footer">
        <button id="confirmOrderBtn" class="btn btn-success">Confirm Order</button>
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>

<!-- FOOTER -->
<footer class="mt-5 py-4 text-center">
  <div class="container">
    <p class="mb-1">&copy; 2025 Sandeep Apparel Store — Made with ♥ in Nashik</p>
    <small>Demo: Frontend cart with localStorage persistence</small>
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
/* =========================
   PRODUCTS DATA (client-side)
   ========================= */
const PRODUCTS = [
  // Shirts
  { id: 's1', title: 'Jocky T-shirt', price: 1000, category: 'Shirts', img: 'https://images.unsplash.com/photo-1581655353564-df123a1eb820?w=800&auto=format&fit=crop&q=60' },
  { id: 's2', title: 'Remond Shirt', price: 1200, category: 'Shirts', img: 'https://i.pinimg.com/736x/05/94/a5/0594a571e01ebe40bd717036e66369ce.jpg' },
  { id: 's3', title: 'Rocky Brand Shirt', price: 500, category: 'Shirts', img: 'https://images.pexels.com/photos/428340/pexels-photo-428340.jpeg' },

  // Pants
  { id: 'p1', title: 'Black Stretch Pant', price: 400, category: 'Pants', img: 'https://images.meesho.com/images/products/394923192/lnfdy_512.webp' },
  { id: 'p2', title: 'Men Beige Trousers', price: 2500, category: 'Pants', img: 'https://ghpc.in/cdn/shop/files/ghpc-polyester-pin-checks-pant-for-men-beige-ghpc-1-35288246223124.jpg' },

  // Shoes
  { id: 'sh1', title: 'Casual Shoe', price: 3000, category: 'Shoes', img: 'https://assets.ajio.com/medias/sys_master/root/20240129/BECS/65b6bf0a16fd2c6e6ac45b86/-473Wx593H-467014777-tan-MODEL7.jpg' },
  { id: 'sh2', title: 'White Casual Shoe', price: 600, category: 'Shoes', img: 'https://5.imimg.com/data5/SELLER/Default/2022/11/KE/VX/MV/116453489/white-casual-shoes-for-men.jpg' },

  // Mobile
  { id: 'm1', title: 'Oppo', price: 13500, category: 'Mobile', img: 'https://opsg-img-cdn-gl.heytapimg.com/epb/202412/19/AceLeaXtntKw1AZf.png' },
  { id: 'm2', title: 'Infinix', price: 10500, category: 'Mobile', img: 'https://cdn.beebom.com/wp-content/uploads/2024/01/Infinix-phone.png' }
];

/* ================
   CART IMPLEMENTATION
   ================ */
const STORAGE_KEY = 'ecom_demo_cart_v1';
let cart = loadCart(); // object { productId: {id, title, price, qty} }

/* DOM references */
const productsGrid = document.getElementById('productsGrid');
const cartCountBadge = document.getElementById('cartCountBadge');
const cartItemsWrap = document.getElementById('cartItemsWrap');
const cartTotalEl = document.getElementById('cartTotal');
const searchInput = document.getElementById('searchInput');
const categoryBtns = document.querySelectorAll('.category-btn');
const clearFiltersBtn = document.getElementById('clearFiltersBtn');

/* Bootstrapped components */
const cartOffcanvasEl = document.getElementById('cartOffcanvas');
const cartOffcanvas = new bootstrap.Offcanvas(cartOffcanvasEl);
const checkoutModal = new bootstrap.Modal(document.getElementById('checkoutModal'));

/* INITIAL RENDER */
renderProducts(PRODUCTS);
renderCart();

/* ---------- PRODUCTS RENDER ---------- */
function renderProducts(list) {
  productsGrid.innerHTML = '';
  const fragment = document.createDocumentFragment();
  list.forEach(p => {
    const col = document.createElement('div');
    col.className = 'col-sm-6 col-md-4 col-lg-3';
    col.innerHTML = `
      <div class="card h-100">
        <img src="${p.img}" class="product-img w-100" alt="${escapeHtml(p.title)}">
        <div class="card-body d-flex flex-column">
          <h6 class="card-title mb-1">${escapeHtml(p.title)}</h6>
          <p class="text-muted mb-2">Rs ${p.price}</p>
          <div class="mt-auto d-flex gap-2">
            <button class="btn btn-sm btn-primary w-100" data-buy="${p.id}"><i class="fa fa-bolt me-1"></i>Buy now</button>
            <button class="btn btn-sm btn-outline-secondary" data-add="${p.id}"><i class="fa fa-cart-plus"></i></button>
          </div>
        </div>
      </div>
    `;
    fragment.appendChild(col);
  });
  productsGrid.appendChild(fragment);

  // add event listeners for the newly rendered buttons
  productsGrid.querySelectorAll('[data-add]').forEach(btn => {
    btn.addEventListener('click', () => addToCart(btn.getAttribute('data-add')));
  });
  productsGrid.querySelectorAll('[data-buy]').forEach(btn => {
    btn.addEventListener('click', (e) => {
      addToCart(btn.getAttribute('data-buy'));
      cartOffcanvas.show();
    });
  });
}

/* ---------- CART FUNCTIONS ---------- */
function addToCart(productId, qty = 1) {
  const product = PRODUCTS.find(p => p.id === productId);
  if (!product) return;
  if (!cart[productId]) {
    cart[productId] = { id: product.id, title: product.title, price: product.price, qty: 0 };
  }
  cart[productId].qty += qty;
  saveCart();
  renderCart();
  // small visual feedback
  flashBadge();
}

function updateQty(productId, newQty) {
  if (!cart[productId]) return;
  if (newQty <= 0) {
    delete cart[productId];
  } else {
    cart[productId].qty = newQty;
  }
  saveCart();
  renderCart();
}

function removeItem(productId) {
  delete cart[productId];
  saveCart();
  renderCart();
}

function clearCart() {
  cart = {};
  saveCart();
  renderCart();
}

/* ---------- RENDER CART UI ---------- */
function renderCart() {
  // update badge
  const totalItems = Object.values(cart).reduce((s, it) => s + it.qty, 0);
  if (totalItems > 0) {
    cartCountBadge.classList.remove('d-none');
    cartCountBadge.textContent = totalItems;
  } else {
    cartCountBadge.classList.add('d-none');
  }

  // items list
  cartItemsWrap.innerHTML = '';
  if (totalItems === 0) {
    cartItemsWrap.innerHTML = '<p class="text-muted">Your cart is empty. Add items to get started.</p>';
    cartTotalEl.textContent = 'Rs 0';
    return;
  }

  const frag = document.createDocumentFragment();
  Object.values(cart).forEach(item => {
    const row = document.createElement('div');
    row.className = 'd-flex align-items-center justify-content-between mb-2 p-2 bg-white rounded shadow-sm';
    row.innerHTML = `
      <div class="me-2" style="width:56px;height:56px;overflow:hidden;border-radius:8px;">
        <img src="${escapeHtml(PRODUCTS.find(p=>p.id===item.id).img)}" style="width:100%;height:100%;object-fit:cover;">
      </div>
      <div class="flex-grow-1 ms-2">
        <div class="fw-semibold">${escapeHtml(item.title)}</div>
        <div class="small text-muted">Rs ${item.price} x ${item.qty} = Rs ${item.price * item.qty}</div>
      </div>
      <div class="d-flex flex-column align-items-end">
        <div class="btn-group btn-group-sm" role="group">
          <button class="btn btn-outline-secondary" data-decr="${item.id}">-</button>
          <button class="btn btn-outline-secondary disabled">${item.qty}</button>
          <button class="btn btn-outline-secondary" data-incr="${item.id}">+</button>
        </div>
        <button class="btn btn-link text-danger small mt-2" data-remove="${item.id}">Remove</button>
      </div>
    `;
    frag.appendChild(row);
  });
  cartItemsWrap.appendChild(frag);

  // wire events
  cartItemsWrap.querySelectorAll('[data-incr]').forEach(b => b.addEventListener('click', () => {
    const id = b.getAttribute('data-incr'); addToCart(id, 1);
  }));
  cartItemsWrap.querySelectorAll('[data-decr]').forEach(b => b.addEventListener('click', () => {
    const id = b.getAttribute('data-decr'); updateQty(id, cart[id].qty - 1);
  }));
  cartItemsWrap.querySelectorAll('[data-remove]').forEach(b => b.addEventListener('click', () => {
    const id = b.getAttribute('data-remove'); removeItem(id);
  }));

  const totalPrice = Object.values(cart).reduce((s, it) => s + it.price * it.qty, 0);
  cartTotalEl.textContent = 'Rs ' + totalPrice;
}

/* ---------- STORAGE ---------- */
function loadCart() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    return raw ? JSON.parse(raw) : {};
  } catch (e) {
    console.error('Could not load cart', e);
    return {};
  }
}
function saveCart() {
  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(cart));
  } catch (e) {
    console.error('Could not save cart', e);
  }
}

/* ---------- UTILITIES ---------- */
function escapeHtml(s){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }

function flashBadge() {
  cartCountBadge.classList.remove('d-none');
  cartCountBadge.classList.add('badge-blink');
  setTimeout(()=>cartCountBadge.classList.remove('badge-blink'), 800);
}

/* ---------- SEARCH & FILTER ---------- */
searchInput.addEventListener('input', () => applyFilters());
categoryBtns.forEach(b => b.addEventListener('click', () => {
  categoryBtns.forEach(x=>x.classList.remove('active'));
  b.classList.add('active');
  applyFilters();
}));
clearFiltersBtn.addEventListener('click', () => {
  searchInput.value = '';
  categoryBtns.forEach(x=>x.classList.remove('active'));
  document.querySelector('.category-btn[data-cat="all"]').classList.add('active');
  renderProducts(PRODUCTS);
});

function applyFilters() {
  const q = searchInput.value.trim().toLowerCase();
  const activeCat = document.querySelector('.category-btn.active')?.getAttribute('data-cat') || 'all';
  const filtered = PRODUCTS.filter(p => {
    const matchesCat = activeCat === 'all' ? true : p.category === activeCat;
    const matchesQ = q === '' ? true : (p.title.toLowerCase().includes(q) || p.category.toLowerCase().includes(q));
    return matchesCat && matchesQ;
  });
  renderProducts(filtered);
}

/* ---------- CHECKOUT FLOW (demo) ---------- */
document.getElementById('checkoutBtn').addEventListener('click', () => {
  const totalPrice = Object.values(cart).reduce((s, it) => s + it.price * it.qty, 0);
  if (totalPrice === 0) {
    alert('Your cart is empty.');
    return;
  }
  // build summary
  const summary = Object.values(cart).map(it => `${it.title} x ${it.qty} = Rs ${it.price * it.qty}`).join('<br>');
  document.getElementById('checkoutSummary').innerHTML = summary + `<hr><strong>Total: Rs ${totalPrice}</strong>`;
  checkoutModal.show();
});

document.getElementById('confirmOrderBtn').addEventListener('click', () => {
  // simulate order placed
  const orderId = 'ORD' + Date.now();
  checkoutModal.hide();
  cartOffcanvas.hide();
  clearCart();
  // simple confirmation
  const content = document.createElement('div');
  content.className = 'p-3';
  content.innerHTML = `<h5 class="mb-2">Order placed ✅</h5>
    <p class="mb-1 small">Your order id: <strong>${orderId}</strong></p>
    <p class="small text-muted">This is a demo. Integrate server-side checkout to persist orders and process payments.</p>`;
  const modal = new bootstrap.Modal(document.createElement('div'));
  const wrapper = document.createElement('div');
  wrapper.className = 'modal fade';
  wrapper.innerHTML = `<div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-body">${content.innerHTML}<div class="text-end"><button class="btn btn-primary" data-bs-dismiss="modal">Close</button></div></div></div></div>`;
  document.body.appendChild(wrapper);
  const newModal = new bootstrap.Modal(wrapper);
  newModal.show();
  wrapper.addEventListener('hidden.bs.modal', ()=> wrapper.remove());
});

/* Clear cart button */
document.getElementById('clearCartBtn').addEventListener('click', () => {
  if (confirm('Clear entire cart?')) clearCart();
});

/* Contact form demo */
document.getElementById('contactForm').addEventListener('submit', (e) => {
  e.preventDefault();
  alert('Thanks ' + document.getElementById('contactName').value + ' — message received!');
  e.target.reset();
});

/* Initial small UX touches */
(function addSmallStyles() {
  const style = document.createElement('style');
  style.textContent = `.badge-blink{ animation: blinker .8s ease; } @keyframes blinker{ 0%{ transform: scale(1); } 50%{ transform: scale(1.2); } 100%{ transform: scale(1); } }`;
  document.head.appendChild(style);
})();
</script>
</body>
</html>
